{% extends "base.html" %}

{% block title %}Edit Book Metadata - Terran Society{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <h1><i class="bi bi-book"></i> Edit Book Metadata</h1>
    </div>
    <div class="col-md-4 text-end">
        <a href="{{ url_for('book_metadata') }}" class="btn btn-secondary">
            <i class="bi bi-x-circle"></i> Cancel
        </a>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <form method="POST">
            <h5>Book Information</h5>
            <div class="row">
                <div class="col-md-8 mb-3">
                    <label for="title" class="form-label">Title *</label>
                    <input type="text" class="form-control" id="title" name="title" 
                           value="{{ metadata.title }}" required>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="current_version" class="form-label">Version *</label>
                    <input type="text" class="form-control" id="current_version" name="current_version" 
                           value="{{ metadata.current_version }}" required placeholder="0.1">
                </div>
            </div>
            
            <div class="mb-3">
                <label for="subtitle" class="form-label">Subtitle</label>
                <input type="text" class="form-control" id="subtitle" name="subtitle" 
                       value="{{ metadata.subtitle or '' }}">
            </div>
            
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="copyright_holder" class="form-label">Copyright Holder *</label>
                    <input type="text" class="form-control" id="copyright_holder" name="copyright_holder" 
                           value="{{ metadata.copyright_holder }}" required>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="copyright_year" class="form-label">Copyright Year</label>
                    <input type="number" class="form-control" id="copyright_year" name="copyright_year" 
                           value="{{ metadata.copyright_year or '' }}" min="2000" max="2100">
                </div>
                <div class="col-md-3 mb-3">
                    <label for="version_date" class="form-label">Version Date</label>
                    <input type="date" class="form-control" id="version_date" name="version_date" 
                           value="{{ metadata.version_date.strftime('%Y-%m-%d') if metadata.version_date else '' }}">
                </div>
            </div>
            
            <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="draft_watermark" name="draft_watermark"
                       {{ 'checked' if metadata.draft_watermark else '' }}>
                <label class="form-check-label" for="draft_watermark">
                    Show "Draft" watermark in generated documents
                </label>
            </div>
            
            <hr>
            <h5>Dedication</h5>
            <div class="mb-3">
                <label for="dedication_text" class="form-label">Dedication Text</label>
                <textarea class="form-control" id="dedication_text" name="dedication_text" rows="3">{{ metadata.dedication_text or '' }}</textarea>
                <div class="form-text">Use multiple lines for multi-line dedications</div>
            </div>
            
            <div class="mb-3">
                <label for="dedication_attribution" class="form-label">Attribution</label>
                <input type="text" class="form-control" id="dedication_attribution" name="dedication_attribution" 
                       value="{{ metadata.dedication_attribution or '' }}" placeholder="e.g., Lao Tzu">
            </div>
            
            <hr>
            <h5>Header & Footer Templates</h5>
            <div class="mb-3">
                <label for="header_odd_template" class="form-label">Odd Page Header Template</label>
                <input type="text" class="form-control" id="header_odd_template" name="header_odd_template" 
                       value="{{ metadata.header_odd_template }}">
                <div class="form-text">Use {chapter_title} for chapter title</div>
            </div>
            
            <div class="mb-3">
                <label for="header_even_template" class="form-label">Even Page Header Template</label>
                <input type="text" class="form-control" id="header_even_template" name="header_even_template" 
                       value="{{ metadata.header_even_template }}">
                <div class="form-text">Use {section_title} for section title</div>
            </div>
            
            <div class="mb-3">
                <label for="footer_template" class="form-label">Footer Template</label>
                <input type="text" class="form-control" id="footer_template" name="footer_template" 
                       value="{{ metadata.footer_template }}">
                <div class="form-text">Use {page_number}, {version}, {date} for dynamic values</div>
            </div>
            
            <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                <a href="{{ url_for('book_metadata') }}" class="btn btn-secondary">
                    <i class="bi bi-x-circle"></i> Cancel
                </a>
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-circle"></i> Save Metadata
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
